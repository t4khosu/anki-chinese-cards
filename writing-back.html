<div class="characters">
    <div class="card-container card-color">
        <div class="description-container">
            <span class="description">Characters</span>
        </div>
        <div class="translation-container" id="translations">{{å®šä¹‰}}</div>
        <div class="character-container">{{æ±‰å­—}}</div>
        <div class="pinyin-container">{{æ‹¼éŸ³}}</div>
        <div id="info" class="info-container">
            <div style="margin-right: 10px">ğŸ’¡</div>
            <div>{{é¢å¤–æ¶ˆæ¯}}</div>
        </div>
        <ul class="examples-container" id="examples"></ul>
        <div class="image-container">
            {{å›¾ç‰‡}}
        </div>
    </div>
</div>


<script>
    function jsonToHtmlList(obj) {
        let result = '<ul>';

        Object.entries(obj).forEach(([key, val]) => {
            if (val !== null && typeof val == 'object' && !Array.isArray(val)) {
                result += `<li>[${key}]</li>`
                result += jsonToHtmlList(val);
            } else {
                result += `<li>[${key}] ${val?.join(", ")}</li>`
            }
        });

        result += '</ul>';
        return result;
    }

    function tryToParseTranslationsToList() {
        const translations = `{{text:å®šä¹‰}}`;
        if (translations[0] !== "{") {
            return;
        }

        const parsed = JSON.parse(translations);
        document.getElementById("translations").innerHTML = jsonToHtmlList(parsed);
    }

    function appendExample(example) {
        if (example === "") {
            return;
        }

        const li = document.createElement("li");
        const hanzi = `{{æ±‰å­—}}`;
        const highlightedHanzi = '<span class="highlighted-character">' + hanzi + '</span>';

        li.innerHTML = example.replaceAll(hanzi, highlightedHanzi);
        document.getElementById("examples").appendChild(li);
    }

    function fixNbsp(element) {
        element.innerHTML = element.innerHTML.replaceAll("&nbsp;", " ");
    }

    function showAdditionalInfoDivIfDefined() {
        if (`{{text:é¢å¤–æ¶ˆæ¯}}`) {
            return;
        }

        document.getElementById("info").style.display = "none";
    }

    showAdditionalInfoDivIfDefined();
    tryToParseTranslationsToList();
    fixNbsp(document.getElementById("translations"));
    appendExample(`{{ä¾‹å­}}`);
    appendExample(`{{ä¾‹å­2}}`);
</script>
